<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3I/ATLAS Real-Time Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to bottom, #000000, #0a0a2e);
            color: #ffffff;
            overflow-x: hidden;
        }
        #header {
            background: rgba(0, 0, 0, 0.9);
            padding: 25px;
            text-align: center;
            border-bottom: 3px solid #00d4ff;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #7b2cbf);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .subtitle {
            color: #aaa;
            font-size: 1.1em;
        }
        .alert-banner {
            background: linear-gradient(90deg, #7b2cbf, #00d4ff);
            padding: 12px;
            text-align: center;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        #controls {
            background: rgba(20, 20, 40, 0.95);
            padding: 18px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            border-bottom: 1px solid #333;
        }
        select, button {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transition: all 0.3s;
            font-weight: 600;
        }
        select:hover, button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        #container {
            display: flex;
            height: calc(100vh - 250px);
        }
        #canvas-container {
            flex: 1;
            position: relative;
        }
        #info-panel {
            width: 350px;
            background: rgba(20, 20, 40, 0.98);
            padding: 25px;
            overflow-y: auto;
            border-left: 2px solid #00d4ff;
        }
        .info-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #333;
        }
        .info-section h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 1.2em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .info-item {
            margin: 12px 0;
            font-size: 0.95em;
            line-height: 1.6;
        }
        .info-label {
            color: #888;
            display: inline-block;
            width: 140px;
            font-weight: 500;
        }
        .info-value {
            color: #fff;
            font-weight: 600;
        }
        .highlight {
            background: rgba(0, 212, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #00d4ff;
            margin: 15px 0;
        }
        #status {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.85);
            padding: 12px 18px;
            border-radius: 8px;
            font-size: 0.95em;
            border: 1px solid rgba(0, 212, 255, 0.5);
        }
        .loading {
            color: #ffa500;
        }
        .success {
            color: #4ade80;
        }
        #date-display {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.85);
            padding: 12px 18px;
            border-radius: 8px;
            font-size: 0.9em;
            border: 1px solid rgba(123, 44, 191, 0.5);
        }
        .fact-box {
            background: linear-gradient(135deg, rgba(123, 44, 191, 0.2), rgba(0, 212, 255, 0.2));
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.9em;
            border: 1px solid rgba(123, 44, 191, 0.3);
        }
    </style>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3I/ATLAS Real-Time Tracker</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to bottom, #000000, #0a0a2e);
        color: #ffffff;
        overflow-x: hidden;
    }
    #header {
        background: rgba(0,0,0,0.9);
        padding: 25px;
        text-align: center;
        border-bottom: 3px solid #00d4ff;
        box-shadow: 0 4px 20px rgba(0,212,255,0.3);
    }
    h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        background: linear-gradient(45deg, #00d4ff, #7b2cbf);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    .subtitle { color: #aaa; font-size: 1.1em; }
    .alert-banner {
        background: linear-gradient(90deg, #7b2cbf, #00d4ff);
        padding: 12px; text-align: center; font-weight: bold;
        animation: pulse 2s infinite; font-size: 1em;
    }
    @keyframes pulse { 0%,100% {opacity:1;} 50%{opacity:0.7;} }

    #controls {
        background: rgba(20,20,40,0.95);
        padding: 18px;
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
        border-bottom: 1px solid #333;
    }
    select, button {
        padding: 12px 24px; font-size: 16px; border: none; border-radius: 8px;
        cursor: pointer; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
        color: white; transition: all 0.3s; font-weight: 600;
    }
    select:hover, button:hover { transform: translateY(-2px); box-shadow:0 5px 20px rgba(102,126,234,0.4); }

    #container { display: flex; height: calc(100vh - 250px); }
    #canvas-container { flex: 1; position: relative; height: 100%; }
    #info-panel {
        width: 350px;
        background: rgba(20,20,40,0.98);
        padding: 25px; overflow-y: auto; border-left: 2px solid #00d4ff;
    }

    .info-section { margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid #333; }
    .info-section h3 {
        color: #00d4ff; margin-bottom: 15px; font-size: 1.2em; text-transform: uppercase; letter-spacing:1px;
    }
    .info-item { margin: 12px 0; font-size: 0.95em; line-height:1.6; }
    .info-label { color:#888; display:inline-block; width:140px; font-weight:500; }
    .info-value { color:#fff; font-weight:600; }
    .highlight { background: rgba(0,212,255,0.2); padding:15px; border-radius:8px; border-left:4px solid #00d4ff; margin:15px 0; }
    .fact-box { background: linear-gradient(135deg,rgba(123,44,191,0.2),rgba(0,212,255,0.2)); padding:12px; border-radius:6px; margin:10px 0; font-size:0.9em; border:1px solid rgba(123,44,191,0.3); }

    #status {
        position:absolute; top:15px; left:15px;
        background: rgba(0,0,0,0.85); padding:12px 18px; border-radius:8px;
        font-size:0.95em; border:1px solid rgba(0,212,255,0.5);
    }
    #date-display {
        position:absolute; top:15px; right:15px; background: rgba(0,0,0,0.85);
        padding:12px 18px; border-radius:8px; font-size:0.9em;
        border:1px solid rgba(123,44,191,0.5);
    }
    .loading { color: #ffa500; }
    .success { color: #4ade80; }

    /* Mobile responsiveness */
    @media (max-width: 900px) {
        #container { flex-direction: column; height:auto; }
        #info-panel { width:100%; border-left:none; border-top:2px solid #00d4ff; padding:15px; }
        #canvas-container { height:60vh; }
        #controls { flex-direction: column; gap:10px; }
        select, button { width:100%; font-size:14px; padding:10px; }
        h1 { font-size:2em; }
        .subtitle { font-size:0.9em; }
        .info-label { width:120px; font-size:0.85em; }
        .info-value { font-size:0.9em; }
        .fact-box { font-size:0.85em; padding:8px; }
        .alert-banner { font-size:0.9em; padding:10px; }
    }
</style>
</head>
<body>
    <div id="header">
        <h1>üåå 3I/ATLAS Live Tracker</h1>
        <p class="subtitle">Real-time 3D visualization of the third interstellar visitor</p>
    </div>
<div id="header">
    <h1>üåå 3I/ATLAS Live Tracker</h1>
    <p class="subtitle">Real-time 3D visualization of the third interstellar visitor</p>
</div>

```
<div class="alert-banner">
    ‚ö° ACTIVE TRACKING: Discovered July 1, 2025 ‚Ä¢ Perihelion Oct 30, 2025 ‚Ä¢ Currently Observable
</div>
@@ -177,6 +118,7 @@ <h1>üåå 3I/ATLAS Live Tracker</h1>
    <button id="toggleLabels">Toggle Labels</button>
    <button id="toggleSpeed">Speed: Normal</button>
    <button id="resetView">Reset View</button>
    <button id="toggleView">View: Solar System</button>
</div>

<div id="container">
@@ -187,42 +129,18 @@ <h1>üåå 3I/ATLAS Live Tracker</h1>
    <div id="info-panel">
        <div class="info-section">
            <h3>üìç Current Position</h3>
            <div class="info-item">
                <span class="info-label">Distance from Sun:</span>
                <span class="info-value" id="distSun">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">Distance from Earth:</span>
                <span class="info-value" id="distEarth">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">Velocity:</span>
                <span class="info-value" id="velocity">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">Phase:</span>
                <span class="info-value" id="phase">Approaching</span>
            </div>
            <div class="info-item"><span class="info-label">Distance from Sun:</span><span class="info-value" id="distSun">-</span></div>
            <div class="info-item"><span class="info-label">Distance from Earth:</span><span class="info-value" id="distEarth">-</span></div>
            <div class="info-item"><span class="info-label">Velocity:</span><span class="info-value" id="velocity">-</span></div>
            <div class="info-item"><span class="info-label">Phase:</span><span class="info-value" id="phase">Approaching</span></div>
        </div>

        <div class="info-section">
            <h3>üî¨ Object Properties</h3>
            <div class="info-item">
                <span class="info-label">Discovery Date:</span>
                <span class="info-value" id="discovery">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">Perihelion:</span>
                <span class="info-value" id="perihelion">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">Eccentricity:</span>
                <span class="info-value" id="eccentricity">-</span>
            </div>
            <div class="info-item">
                <span class="info-label">Nucleus Size:</span>
                <span class="info-value" id="size">-</span>
            </div>
            <div class="info-item"><span class="info-label">Discovery Date:</span><span class="info-value" id="discovery">-</span></div>
            <div class="info-item"><span class="info-label">Perihelion:</span><span class="info-value" id="perihelion">-</span></div>
            <div class="info-item"><span class="info-label">Eccentricity:</span><span class="info-value" id="eccentricity">-</span></div>
            <div class="info-item"><span class="info-label">Nucleus Size:</span><span class="info-value" id="size">-</span></div>
        </div>

        <div class="highlight">
@@ -249,373 +167,154 @@ <h3>‚ÑπÔ∏è About 3I/ATLAS</h3>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
    let scene, camera, renderer;
    let sun, earth, mars, jupiter, venus, mercury, interstellarObj;
    let orbitLine, showOrbit = true, showLabels = true;
    let animationId;
    let timeSpeed = 1;
    let currentDate = new Date('2025-10-17');

    const AU = 150;
    
    // === Scene Setup ===
    let scene, camera, renderer, earthCamera;
    let sun, mercury, venus, earth, mars, jupiter, interstellarObj;
    let orbitLine, showOrbit=true, showLabels=true;
    let animationId, timeSpeed=1, currentDate=new Date('2025-10-17'), time=0;
    let useEarthView = false;

    const AU=150;
    const objectData = {
        atlas: {
            name: "3I/ATLAS",
            fullName: "3I/ATLAS (C/2025 N1)",
            discovery: "July 1, 2025",
            perihelion: "1.4 AU (Oct 30, 2025)",
            perihelionDate: new Date('2025-10-30'),
            perihelionDist: 1.4,
            color: 0x00d4ff,
            eccentricity: 6.2,
            semiMajorAxis: -0.5,
            inclination: 45 * Math.PI / 180,
            argumentOfPerihelion: 215 * Math.PI / 180,
            longitudeOfNode: 310 * Math.PI / 180,
            velocity: 67.5,
            size: "0.44-5.6 km",
            observations: "Unusual nickel emissions detected with no iron vapor. Anti-tail phenomenon observed. Active coma with water vapor and cyanide detected."
        },
        oumuamua: {
            name: "1I/'Oumuamua",
            fullName: "1I/'Oumuamua",
            discovery: "Oct 19, 2017",
            perihelion: "0.25 AU (Sep 9, 2017)",
            perihelionDate: new Date('2017-09-09'),
            perihelionDist: 0.25,
            color: 0xff6b6b,
            eccentricity: 1.2,
            semiMajorAxis: -1.3,
            inclination: 122.7 * Math.PI / 180,
            argumentOfPerihelion: 241.8 * Math.PI / 180,
            longitudeOfNode: 24.6 * Math.PI / 180,
            velocity: 26.33,
            size: "~100-1000 m",
            observations: "Cigar or pancake-shaped object with unusual acceleration. First confirmed interstellar visitor."
        },
        borisov: {
            name: "2I/Borisov",
            fullName: "2I/Borisov (C/2019 Q4)",
            discovery: "Aug 30, 2019",
            perihelion: "2.01 AU (Dec 8, 2019)",
            perihelionDate: new Date('2019-12-08'),
            perihelionDist: 2.01,
            color: 0x4ecdc4,
            eccentricity: 3.36,
            semiMajorAxis: -0.85,
            inclination: 44.05 * Math.PI / 180,
            argumentOfPerihelion: 209.13 * Math.PI / 180,
            longitudeOfNode: 308.15 * Math.PI / 180,
            velocity: 32.2,
            size: "~1 km",
            observations: "Most 'normal' interstellar object, resembling solar system comets. Active coma observed."
        }
        atlas: {name:"3I/ATLAS", fullName:"3I/ATLAS (C/2025 N1)", discovery:"July 1, 2025",
            perihelion:"1.4 AU (Oct 30, 2025)", perihelionDate:new Date('2025-10-30'), perihelionDist:1.4,
            color:0x00d4ff, eccentricity:6.2, semiMajorAxis:-0.5, inclination:45*Math.PI/180,
            argumentOfPerihelion:215*Math.PI/180, longitudeOfNode:310*Math.PI/180, velocity:67.5,
            size:"0.44-5.6 km", observations:"Unusual nickel emissions detected with no iron vapor. Anti-tail phenomenon observed. Active coma with water vapor and cyanide detected."},
        oumuamua: {name:"1I/'Oumuamua", fullName:"1I/'Oumuamua", discovery:"Oct 19, 2017",
            perihelion:"0.25 AU (Sep 9, 2017)", perihelionDate:new Date('2017-09-09'), perihelionDist:0.25,
            color:0xff6b6b, eccentricity:1.2, semiMajorAxis:-1.3, inclination:122.7*Math.PI/180,
            argumentOfPerihelion:241.8*Math.PI/180, longitudeOfNode:24.6*Math.PI/180, velocity:26.33,
            size:"~100-1000 m", observations:"Cigar or pancake-shaped object with unusual acceleration. First confirmed interstellar visitor."},
        borisov: {name:"2I/Borisov", fullName:"2I/Borisov (C/2019 Q4)", discovery:"Aug 30, 2019",
            perihelion:"2.01 AU (Dec 8, 2019)", perihelionDate:new Date('2019-12-08'), perihelionDist:2.01,
            color:0x4ecdc4, eccentricity:3.36, semiMajorAxis:-0.85, inclination:44.05*Math.PI/180,
            argumentOfPerihelion:209.13*Math.PI/180, longitudeOfNode:308.15*Math.PI/180, velocity:32.33,
            size:"~1 km", observations:"Second confirmed interstellar object, active coma, more comet-like behavior."}
    };

    let currentObject = 'atlas';
    let time = 0;
    init();
    animate();

    function init() {
        const container = document.getElementById('canvas-container');
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10000);
        camera.position.set(0, 300, 500);
        camera.lookAt(0, 0, 0);

        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(document.getElementById('canvas-container').clientWidth, 
                       document.getElementById('canvas-container').clientHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // Enhanced starfield
        const starsGeometry = new THREE.BufferGeometry();
        const starsMaterial = new THREE.PointsMaterial({ 
            color: 0xffffff, 
            size: 2,
            transparent: true,
            opacity: 0.8
        });
        const starsVertices = [];
        for (let i = 0; i < 2000; i++) {
            const x = (Math.random() - 0.5) * 5000;
            const y = (Math.random() - 0.5) * 5000;
            const z = (Math.random() - 0.5) * 5000;
            starsVertices.push(x, y, z);
        }
        starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
        const stars = new THREE.Points(starsGeometry, starsMaterial);
        scene.add(stars);

        // Sun with enhanced glow
        const sunGeometry = new THREE.SphereGeometry(25, 32, 32);
        const sunMaterial = new THREE.MeshBasicMaterial({ color: 0xffff00 });
        sun = new THREE.Mesh(sunGeometry, sunMaterial);
        camera = new THREE.PerspectiveCamera(60, container.clientWidth/container.clientHeight, 0.1, 10000);
        camera.position.set(0, AU*2, AU*4);
        camera.lookAt(0,0,0);

        renderer = new THREE.WebGLRenderer({antialias:true});
        renderer.setSize(container.clientWidth, container.clientHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        container.appendChild(renderer.domElement);

        // Sun
        const sunGeo = new THREE.SphereGeometry(AU*0.05,32,32);
        const sunMat = new THREE.MeshBasicMaterial({color:0xffff00});
        sun = new THREE.Mesh(sunGeo, sunMat);
        scene.add(sun);

        const glowGeometry = new THREE.SphereGeometry(35, 32, 32);
        const glowMaterial = new THREE.MeshBasicMaterial({ 
            color: 0xffaa00, 
            transparent: true, 
            opacity: 0.3 
        });
        const glow = new THREE.Mesh(glowGeometry, glowMaterial);
        sun.add(glow);

        // Planets with labels
        mercury = createPlanet(58, 0x8c7853, 3, 'Mercury');
        venus = createPlanet(108, 0xffc649, 6, 'Venus');
        earth = createPlanet(AU, 0x2233ff, 6, 'Earth');
        mars = createPlanet(228, 0xff6347, 4.5, 'Mars');
        jupiter = createPlanet(520, 0xffa500, 18, 'Jupiter');

        // Interstellar object
        createInterstellarObject();

        // Lighting
        const ambientLight = new THREE.AmbientLight(0x404040, 1.5);
        scene.add(ambientLight);
        const pointLight = new THREE.PointLight(0xffffff, 2.5, 2500);
        scene.add(pointLight);
        // Earth
        const earthGeo = new THREE.SphereGeometry(AU*0.02,32,32);
        const earthMat = new THREE.MeshPhongMaterial({color:0x2266ff});
        earth = new THREE.Mesh(earthGeo, earthMat);
        scene.add(earth);

        setupMouseControls();
        // Light
        const light = new THREE.PointLight(0xffffff, 2, 0);
        light.position.set(0,0,0);
        scene.add(light);

        document.getElementById('objectSelect').addEventListener('change', (e) => {
            currentObject = e.target.value;
            updateInterstellarObject();
        });
        document.getElementById('toggleOrbit').addEventListener('click', toggleOrbitVisibility);
        document.getElementById('toggleLabels').addEventListener('click', toggleLabelsVisibility);
        document.getElementById('toggleSpeed').addEventListener('click', toggleTimeSpeed);
        document.getElementById('resetView').addEventListener('click', resetCamera);

        window.addEventListener('resize', onWindowResize);

        updateStatus('Tracking ' + objectData[currentObject].fullName, 'success');
        updateInfo();
        animate();
    }

    function createPlanet(distance, color, size, name) {
        const geometry = new THREE.SphereGeometry(size, 32, 32);
        const material = new THREE.MeshPhongMaterial({ color: color });
        const planet = new THREE.Mesh(geometry, material);
        
        const orbitGeometry = new THREE.RingGeometry(distance - 0.5, distance + 0.5, 128);
        const orbitMaterial = new THREE.MeshBasicMaterial({ 
            color: 0x444444, 
            side: THREE.DoubleSide,
            transparent: true,
            opacity: 0.2
        });
        const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
        orbit.rotation.x = Math.PI / 2;
        scene.add(orbit);
        
        scene.add(planet);
        planet.userData.distance = distance;
        planet.userData.name = name;
        return planet;
    }

    function createInterstellarObject() {
        const geometry = new THREE.SphereGeometry(5, 16, 16);
        const material = new THREE.MeshBasicMaterial({ 
            color: objectData[currentObject].color 
        });
        interstellarObj = new THREE.Mesh(geometry, material);
        
        // Add glow effect
        const glowGeo = new THREE.SphereGeometry(8, 16, 16);
        const glowMat = new THREE.MeshBasicMaterial({
            color: objectData[currentObject].color,
            transparent: true,
            opacity: 0.4
        });
        const glowMesh = new THREE.Mesh(glowGeo, glowMat);
        interstellarObj.add(glowMesh);
        
        scene.add(interstellarObj);
        createOrbitPath();
    }

    function createOrbitPath() {
        if (orbitLine) scene.remove(orbitLine);
        
        // Orbit line
        const lineMaterial = new THREE.LineBasicMaterial({color:0xffffff});
        const points = [];
        const data = objectData[currentObject];
        
        for (let i = 0; i <= 800; i++) {
            const t = (i / 800) * Math.PI * 5 - Math.PI * 2.5;
            const pos = calculateHyperbolicPosition(t, data);
            points.push(new THREE.Vector3(pos.x, pos.y, pos.z));
        for(let i=0;i<360;i+=5){
            let rad=i*Math.PI/180;
            points.push(new THREE.Vector3(Math.cos(rad)*AU,0,Math.sin(rad)*AU));
        }
        
        const geometry = new THREE.BufferGeometry().setFromPoints(points);
        const material = new THREE.LineBasicMaterial({ 
            color: objectData[currentObject].color,
            transparent: true,
            opacity: 0.7,
            linewidth: 2
        });
        orbitLine = new THREE.Line(geometry, material);
        orbitLine.visible = showOrbit;
        const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
        orbitLine = new THREE.Line(lineGeometry,lineMaterial);
        scene.add(orbitLine);
    }

    function calculateHyperbolicPosition(t, data) {
        const a = data.semiMajorAxis * AU;
        const e = data.eccentricity;
        const i = data.inclination;
        const w = data.argumentOfPerihelion;
        const o = data.longitudeOfNode;
        
        const M = t;
        const F = M;
        
        const r = Math.abs(a) * (e * Math.cosh(F) - 1);
        const v = 2 * Math.atan(Math.sqrt((e + 1) / (e - 1)) * Math.tanh(F / 2));
        
        const xOrb = r * Math.cos(v);
        const yOrb = r * Math.sin(v);
        
        const x = (Math.cos(o) * Math.cos(w) - Math.sin(o) * Math.sin(w) * Math.cos(i)) * xOrb +
                 (-Math.cos(o) * Math.sin(w) - Math.sin(o) * Math.cos(w) * Math.cos(i)) * yOrb;
        const y = (Math.sin(o) * Math.cos(w) + Math.cos(o) * Math.sin(w) * Math.cos(i)) * xOrb +
                 (-Math.sin(o) * Math.sin(w) + Math.cos(o) * Math.cos(w) * Math.cos(i)) * yOrb;
        const z = (Math.sin(w) * Math.sin(i)) * xOrb + (Math.cos(w) * Math.sin(i)) * yOrb;
        
        return { x, y, z };
    }

    function updateInterstellarObject() {
        scene.remove(interstellarObj);
        createInterstellarObject();
        updateInfo();
        updateStatus('Tracking ' + objectData[currentObject].fullName, 'success');
    }
        // Interstellar object
        const objGeo = new THREE.SphereGeometry(AU*0.015,16,16);
        const objMat = new THREE.MeshPhongMaterial({color:objectData.atlas.color});
        interstellarObj = new THREE.Mesh(objGeo,objMat);
        scene.add(interstellarObj);

    function setupMouseControls() {
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };
        
        renderer.domElement.addEventListener('mousedown', () => isDragging = true);
        renderer.domElement.addEventListener('mouseup', () => isDragging = false);
        renderer.domElement.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const deltaX = e.offsetX - previousMousePosition.x;
                const deltaY = e.offsetY - previousMousePosition.y;
                
                const angle = camera.position.clone().normalize();
                const right = new THREE.Vector3(-angle.z, 0, angle.x).normalize();
                const up = new THREE.Vector3(0, 1, 0);
                
                camera.position.add(right.multiplyScalar(-deltaX * 0.8));
                camera.position.add(up.multiplyScalar(deltaY * 0.8));
                camera.lookAt(0, 0, 0);
            }
            previousMousePosition = { x: e.offsetX, y: e.offsetY };
        // Event listeners
        window.addEventListener('resize', onWindowResize,false);
        document.getElementById('toggleOrbit').addEventListener('click',()=>{showOrbit=!showOrbit; orbitLine.visible=showOrbit;});
        document.getElementById('toggleLabels').addEventListener('click',()=>{showLabels=!showLabels;});
        document.getElementById('resetView').addEventListener('click',()=>{camera.position.set(0, AU*2, AU*4); camera.lookAt(0,0,0);});
        document.getElementById('toggleView').addEventListener('click',()=>{
            useEarthView=!useEarthView;
            document.getElementById('toggleView').innerText = useEarthView ? "View: Earth Portal" : "View: Solar System";
        });
        
        renderer.domElement.addEventListener('wheel', (e) => {
            e.preventDefault();
            const zoomSpeed = 25;
            const direction = camera.position.clone().normalize();
            camera.position.addScaledVector(direction, e.deltaY > 0 ? zoomSpeed : -zoomSpeed);
        });
    }
        document.getElementById('objectSelect').addEventListener('change', (e)=>updateObject(e.target.value));

    function toggleOrbitVisibility() {
        showOrbit = !showOrbit;
        if (orbitLine) orbitLine.visible = showOrbit;
        setupTouchControls();
    }

    function toggleLabelsVisibility() {
        showLabels = !showLabels;
    function setupTouchControls(){
        let isDragging=false, prev={x:0,y:0};
        renderer.domElement.addEventListener('touchstart', (e)=>{
            if(e.touches.length===1){ isDragging=true; prev.x=e.touches[0].clientX; prev.y=e.touches[0].clientY; }
        });
        renderer.domElement.addEventListener('touchmove', (e)=>{
            if(isDragging && e.touches.length===1){
                const dx=e.touches[0].clientX-prev.x, dy=e.touches[0].clientY-prev.y;
                camera.position.x-=dx*0.5; camera.position.y+=dy*0.5;
                camera.lookAt(0,0,0);
                prev.x=e.touches[0].clientX; prev.y=e.touches[0].clientY;
            }
        });
        renderer.domElement.addEventListener('touchend', ()=>isDragging=false);
    }

    function toggleTimeSpeed() {
        const speeds = [1, 5, 10, 30];
        const idx = speeds.indexOf(timeSpeed);
        timeSpeed = speeds[(idx + 1) % speeds.length];
        document.getElementById('toggleSpeed').textContent = `Speed: ${timeSpeed}x`;
    function updateObject(objKey){
        const obj = objectData[objKey];
        interstellarObj.material.color.set(obj.color);
        document.getElementById('distSun').innerText='Updating...';
        document.getElementById('distEarth').innerText='Updating...';
        document.getElementById('velocity').innerText=obj.velocity+' km/s';
        document.getElementById('discovery').innerText=obj.discovery;
        document.getElementById('perihelion').innerText=obj.perihelion;
        document.getElementById('eccentricity').innerText=obj.eccentricity;
        document.getElementById('size').innerText=obj.size;
        document.getElementById('observations').innerText=obj.observations;
    }

    function resetCamera() {
        camera.position.set(0, 300, 500);
        camera.lookAt(0, 0, 0);
    }
    function animate(){
        animationId=requestAnimationFrame(animate);

    function updateInfo() {
        const data = objectData[currentObject];
        const pos = calculateHyperbolicPosition(time * 0.005, data);
        const distSun = Math.sqrt(pos.x * pos.x + pos.y * pos.y + pos.z * pos.z) / AU;
        const earthPos = { x: AU * Math.cos(time * 0.01), y: 0, z: AU * Math.sin(time * 0.01) };
        const distEarth = Math.sqrt(
            Math.pow(pos.x - earthPos.x, 2) + 
            Math.pow(pos.y - earthPos.y, 2) + 
            Math.pow(pos.z - earthPos.z, 2)
        ) / AU;
        
        const phase = distSun < data.perihelionDist + 0.5 ? 'At Perihelion' : 
                     (time < 100 ? 'Approaching' : 'Departing');
        
        document.getElementById('distSun').textContent = distSun.toFixed(2) + ' AU';
        document.getElementById('distEarth').textContent = distEarth.toFixed(2) + ' AU';
        document.getElementById('velocity').textContent = data.velocity + ' km/s';
        document.getElementById('discovery').textContent = data.discovery;
        document.getElementById('perihelion').textContent = data.perihelion;
        document.getElementById('eccentricity').textContent = data.eccentricity.toFixed(1);
        document.getElementById('size').textContent = data.size;
        document.getElementById('phase').textContent = phase;
        document.getElementById('observations').textContent = data.observations;
    }
        // Simple orbit animation
        const t = time*0.001*timeSpeed;
        const obj = objectData[document.getElementById('objectSelect').value];
        const a=obj.semiMajorAxis*AU;
        const e=obj.eccentricity;
        const x=a*(Math.cos(t)-e);
        const z=a*Math.sqrt(1-e*e)*Math.sin(t);
        interstellarObj.position.set(x,0,z);

    function updateStatus(message, className) {
        const status = document.getElementById('status');
        status.textContent = message;
        status.className = className;
    }
        // Earth orbit
        earth.position.set(AU*Math.cos(t*0.5),0,AU*Math.sin(t*0.5));

    function animate() {
        animationId = requestAnimationFrame(animate);
        
        time += 0.3 * timeSpeed;
        
        currentDate.setHours(currentDate.getHours() + timeSpeed);
        document.getElementById('date-display').textContent = 
            'Date: ' + currentDate.toLocaleDateString('en-US', {month: 'short', day: 'numeric', year: 'numeric'});
        
        const planets = [mercury, venus, earth, mars, jupiter];
        planets.forEach((planet, i) => {
            if (planet) {
                const speed = 0.008 / (i + 0.5);
                const angle = time * speed;
                planet.position.x = planet.userData.distance * Math.cos(angle);
                planet.position.z = planet.userData.distance * Math.sin(angle);
            }
        });
        
        if (interstellarObj) {
            const data = objectData[currentObject];
            const pos = calculateHyperbolicPosition(time * 0.005, data);
            interstellarObj.position.set(pos.x, pos.y, pos.z);
        if(useEarthView){
            camera.position.copy(earth.position.clone().add(new THREE.Vector3(0,AU*0.5,AU*1)));
            camera.lookAt(interstellarObj.position);
        }
        
        if (time % 30 === 0) updateInfo();
        
        renderer.render(scene, camera);

        renderer.render(scene,camera);
        time++;
    }

    function onWindowResize() {
        camera.aspect = document.getElementById('canvas-container').clientWidth / 
                      document.getElementById('canvas-container').clientHeight;
    function onWindowResize(){
        const container=document.getElementById('canvas-container');
        camera.aspect=container.clientWidth/container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(document.getElementById('canvas-container').clientWidth,
                       document.getElementById('canvas-container').clientHeight);
        renderer.setSize(container.clientWidth,container.clientHeight);
    }

    init();
</script>
```

</body>
</html>
</html>
